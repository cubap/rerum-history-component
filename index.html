<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>RERUM History Tree</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script type="module" src="./src/rerum-history-tree.js"></script>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
      .panel { display: grid; gap: .5rem; max-width: 820px; margin-bottom: 1rem; }
      label { display: grid; gap: .25rem; }
      input { padding: .5rem; border: 1px solid #ccc; border-radius: 6px; }
      button { padding: .5rem .75rem; border: 1px solid #ccc; border-radius: 6px; background: #f6f6f6; cursor: pointer; }
      button:hover { background: #eee; }
      .note { color: #666; font-size: .875rem; }
      rerum-history-tree { display: block; border: 1px solid #e5e7eb; border-radius: 8px; padding: .75rem; }
    </style>
  </head>
  <body>
    <h1>RERUM History Tree</h1>

    <div class="panel">
      <label>
        RERUM ID Base (ends with /id)
        <input id="apiBase" placeholder="https://store.rerum.io/v1/id" value="https://store.rerum.io/v1/id" />
      </label>
      <label>
        Document ID (full URL)
        <input id="docId" placeholder="https://store.rerum.io/v1/id/..." value="https://store.rerum.io/v1/id/689e4322e25481fd578a61c7" />
      </label>
      <label>
        Node label key (optional)
        <input id="labelKey" placeholder="label" />
      </label>
      <div>
        <button id="loadBtn">Load</button>
        <span class="note">Supports dev at https://devstore.rerum.io/v1/id</span>
      </div>
    </div>

    <rerum-history-tree id="tree"></rerum-history-tree>

    <script type="module">
      const tree = document.getElementById('tree');
      document.getElementById('loadBtn').addEventListener('click', () => {
        const apiBase = document.getElementById('apiBase').value.trim();
        const docId = document.getElementById('docId').value.trim();
        const labelKey = document.getElementById('labelKey').value.trim() || null;
        if (!apiBase || !docId) {
          alert('Please provide both API Base and Document ID.');
          return;
        }
        tree.setAttribute('api-base', apiBase);
        tree.setAttribute('document-id', docId);
        if (labelKey) tree.setAttribute('node-label-key', labelKey);
        else tree.removeAttribute('node-label-key');
      });

      tree.addEventListener('nodeclick', (e) => {
        console.log('Node clicked:', e.detail);
      });
      tree.addEventListener('loaded', (e) => {
        console.log('Loaded:', e.detail);
      });
      tree.addEventListener('error', (e) => {
        console.error('Error:', e.detail.error);
      });
    </script>
  </body>
</html>