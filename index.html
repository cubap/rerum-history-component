<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>RERUM History Tree</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <script type="module" src="./src/rerum-history-tree.js"></script>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
      .panel { display: grid; gap: .5rem; max-width: 820px; margin-bottom: 1rem; }
      label { display: grid; gap: .25rem; }
      input { padding: .5rem; border: 1px solid #ccc; border-radius: 6px; }
      button { padding: .5rem .75rem; border: 1px solid #ccc; border-radius: 6px; background: #f6f6f6; cursor: pointer; }
      button:hover { background: #eee; }
      .note { color: #666; font-size: .875rem; }
      rerum-history-tree { display: block; border: 1px solid #e5e7eb; border-radius: 8px; padding: .75rem; }
    </style>
  </head>
  <body>
    <h1>RERUM History Tree</h1>

    <div class="panel">
      <label>
        Document URI (RERUM document with /id/ in path)
        <input id="docUri" placeholder="https://store.rerum.io/v1/id/..." value="https://devstore.rerum.io/v1/id/68dc8ff361788256c7927dd0" />
      </label>
      <label>
        Node label key (optional)
        <input id="labelKey" placeholder="label" />
      </label>
      <div>
        <button id="loadBtn">Load</button>
        <span class="note">Supports dev at https://devstore.rerum.io/v1/id</span>
      </div>
    </div>

    <rerum-history-tree id="tree"></rerum-history-tree>

    <script type="module">
      const tree = document.getElementById('tree')
      document.getElementById('loadBtn').addEventListener('click', () => {
        const docUri = document.getElementById('docUri').value.trim()
        const labelKey = document.getElementById('labelKey').value.trim() || null
        if (!docUri) {
          alert('Please provide a Document URI.')
          return
        }
        if (!docUri.includes('/id/')) {
          alert('Document URI must contain "/id/" in the path.')
          return
        }
        tree.setAttribute('document-uri', docUri)
        if (labelKey) {
          tree.setAttribute('node-label-key', labelKey)
          return
        }
        tree.removeAttribute('node-label-key')
      })

      tree.addEventListener('nodeclick', (e) => {
        console.log('Node clicked:', e.detail)
      })
      tree.addEventListener('loaded', (e) => {
        console.log('Loaded:', e.detail)
      })
      tree.addEventListener('error', (e) => {
        console.error('Error:', e.detail.error)
      })
    </script>
  </body>
</html>
